# Chromalisk
# Enemy that roams around, and attacks the player if spotted.
# Can jump. Can attack while jumping. Can cloak.

{
#------GLOBAL VALUES------#
id: "chroma_norm",
prototype: ["hittable"],
solid_dimensions: ["common","~enemy", "~hazard"],
collide_dimensions: ["common", "enemy", "~hazard"],
editor_info: { category: "Monsters, Beasts" },
friction: 2000,
hitpoints: 200,
max_hitpoints: 200,
mass: 5,
traction: 1000,
traction_in_air: 1000,

#------PROPERTIES------#
properties: {
	team: "'evil'",
	stand_ticks: { type: "int", default: 2 },

player_noticeable: "bool :: (player_in_decent_y_pos and abs(level.player.midpoint_x - self.midpoint_x) < if(self.facing = desired_facing, front_detection_area, rear_detection_area))",
	player_in_target_area:  "if(player_noticeable and self.facing = desired_facing, 1, 0)",
	desired_facing: "int :: if(level.player.midpoint_x < self.midpoint_x, -1, 1)",
	rear_detection_area: "if(higher_difficulty, 1200, 200)",
	front_detection_area: "if(higher_difficulty, 1200, 400)",
	player_in_decent_y_pos: "(level.player.midpoint_y > self.y and level.player.midpoint_y < self.y2)",
},

#------ANIMATION HANDLES------#
on_create: "animation('stand')",
on_end_stand_anim: "if(stand_ticks != 0,
						[animation('stand'), add(stand_ticks, -1)],
						animation('walk'),
						)",
on_end_walk_anim: "animation('walk')",
on_process_walk: "set(velocity_x, facing*200)",
on_collide_side: "[animation('turn'), set(stand_ticks, 5)]",
on_end_turn_anim: "[set(facing, -facing), animation('stand')]",

#------ANIMATIONS------#
animation: [
	{
		id: "stand",
		body_area: "all",
		image: "beast/chroma_norm.png",
		rect: [2,2,33,28],
		solid_area: [5,8,27,25],
		frames: 1,
		duration: 10,
		accel_x: 0,
		accel_y: 100
	},
	
	{
		id: "walk",
		body_area: "all",
		image: "beast/chroma_norm.png",
		rect: [2,33,33,59],
		solid_area: [5,8,27,25],
		pad: 3,
		frames: 4,
		duration: 6,
		frames_per_row: 4,
		accel_x: 0,
		accel_y: 100
	},
	
	{
		id: "turn",
		body_area: "all",
		image: "beast/chroma_norm.png",
		rect: [2,2,33,28],
		solid_area: [5,8,27,25],
		frames: 1,
		duration: 5,
		accel_x: 0,
		accel_y: 100
	},
],
}
