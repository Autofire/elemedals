# Pivot
# Main player.
# TODO:
# Give Pivot a turn animation (Will not interfere with other actions)
# Make Pivot jump properly

{
#DEFINES#
id: "pivot_playable",
editor_info: { category: "player" },
solid_dimensions: ["player","common","boss"],
vehicle: false,
hitpoints: 6,
mass: 5,
is_human: true,
friction: 2750,
traction_in_air: 10,
traction_in_water: 1000,
feet_width: 6,

properties: {
	# vars in all caps are normal values.
	# If the used variable is changed for some reason,
	# i.e. player gets stunned, then the original value can
	# be reverted back too.
	
	# The reason for doing things like this is because certain
	# items might change these values.
	
	RUNSPEED: 190,
	runspeed: 190,

	JUMPHEIGHT: -1600,		# Height of the initial jump
	jumpheight: -1600
},

#ANIMATION HANDLES#
on_create: "animation('stand')",
on_end_stand_anim: "animation('stand')",
on_collide_feet: "[animation('stand'), set(jumpticks, 20)]",

#Controller inputs -- stuff that is usually related to the player's input
on_process: "[if((ctrl_left or ctrl_right) and animation in ['stand'],
				set(animation, 'run')),
			if(ctrl_left, [set(facing, -1), add(velocity_x, -runspeed)]),
			if(ctrl_right, [set(facing, 1), add(velocity_x, runspeed)]),
			debug(jumpticks)
			]",
			
on_process_run: "if(not (ctrl_left or ctrl_right),
					animation('stand'),
					set(facing, if(ctrl_left, -1, 1)))",
on_end_run_anim: "animation('run')",

on_ctrl_jump: "if(animation = 'stand' or animation = 'run',
				[animation('jump'), add(velocity_y, jumpheight)]
				)",
on_process_jump: "if(ctrl_jump = 1 and jumpticks != 0,
					[add(velocity_y, -60), set(jumpticks, jumpticks - 1)],
					[animation('fall'), set(jumpticks, 0)]
					)",

#ANIMATIONS#
animation: [
	{
		id: "stand",
		body_area: "all",
		image: "pivot/pivot_basic.png",
		rect: [2, 2, 22, 33],
		solid_area: [3,5,18,30],
		frames: 1,
		frames_per_row: 1,
		duration: 1,
		accel_y: 80,
		accel_x: 0,
	},
	
	{
		id: "run",
		body_area: "all",
		image: "pivot/pivot_basic.png",
		rect: [32, 2, 58, 33],
		solid_area: [5,5,20,30],
		frames: 4,
		frames_per_row: 4,
		pad: 3,
		duration: 8,
		accel_y: 80,
		accel_x: 0,
	},
	
	{
		id: "jump",
		body_area: "all",
		image: "pivot/pivot_basic.png",
		rect: [2, 38, 22, 69],
		solid_area: [2,3,17,28],
		frames: 1,
		duration: 1,
		accel_y: 80,
		accel_x: 0
	},
	
	{
		id: "fall",
		body_area: "all",
		image: "pivot/pivot_basic.png",
		rect: [29, 38, 50, 69],
		solid_area: [2,3,17,28],
		frames: 1,
		duration: 1,
		accel_y: 80,
		accel_x: 0	
	},
],
}
